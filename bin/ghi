#!/usr/bin/env node
'use strict';

var program = require('commander');
var fs = require('fs');
var path = require('path');

var config;

// Search for the config.json file in the current directory
if (fs.existsSync(path.join(__dirname, '../config.json'))) {
  config = require('../config.json');
} else {
  console.log('You must set your GitHub token');
  console.log('Create a token using the GitHub web interface that has admin:org access');
  console.log('Run the following command to create a config.json file, add your token, then try again.');
  console.log('cp ' + path.join(__dirname, '../config.json.example') + ' ' + path.join(__dirname, '../config.json') + ' && vim ' + path.join(__dirname, '../config.json'));
  process.exit();
}

program
  .version('0.0.1')
  .option('-c, --config [object]', 'configuration object', config);

program
  .on('*', function(name) {
    console.log('\''+name+'\' is not a known command. See \'ghi --help\':');
    program.outputHelp();
    process.exit(1);
  });

require('../cmds/repo.js')(program);

program
  .parse(process.argv);

if (program.args.length < 1 ) {
  console.log('No command specified. See \'ghi --help\':');
  program.outputHelp();
  process.exit(1);
}
